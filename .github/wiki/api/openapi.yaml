openapi: 3.0.3
info:
  title: nself-chat (nchat) API
  version: 0.9.1
  description: |
    **nself-chat (nchat)** is a white-label team communication platform combining features from Slack, Discord, and Telegram.

    This API provides endpoints for:
    - Application health and monitoring
    - Configuration management
    - Authentication
    - File uploads
    - Search
    - Webhooks
    - Audit logging
    - Translation and link previews

    ## Authentication

    Most endpoints require authentication via Bearer token in the Authorization header:
    ```
    Authorization: Bearer <jwt-token>
    ```

    Admin-only endpoints require the authenticated user to have `owner` or `admin` role.

    ## Rate Limiting

    Most endpoints are rate-limited to prevent abuse:
    - Default: 60 requests per minute
    - Upload: 30 requests per minute
    - Search: 60 requests per minute
    - Webhooks: 30 requests per minute per webhook

    Rate limit headers are included in responses:
    - `X-RateLimit-Limit`: Maximum requests per window
    - `X-RateLimit-Remaining`: Remaining requests in current window
    - `X-RateLimit-Reset`: Unix timestamp when the limit resets

    ## Error Responses

    All error responses follow a consistent format:
    ```json
    {
      "success": false,
      "error": "Human-readable error message",
      "code": "ERROR_CODE",
      "details": {}
    }
    ```
  contact:
    name: nself-chat Support
    url: https://github.com/nself-chat
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: http://localhost:3000
    description: Local development server
  - url: https://api.nchat.app
    description: Production server

tags:
  - name: Health
    description: Health check and monitoring endpoints
  - name: Configuration
    description: Application configuration management
  - name: Authentication
    description: User authentication and authorization
  - name: Upload
    description: File upload and storage
  - name: Search
    description: Full-text search across resources
  - name: Translation
    description: Message translation service
  - name: Link Preview
    description: URL metadata extraction
  - name: Webhooks
    description: Incoming webhook integrations
  - name: Audit
    description: Audit logging and compliance
  - name: Metrics
    description: Prometheus metrics export
  - name: Setup
    description: Initial setup wizard

paths:
  /api/health:
    get:
      tags:
        - Health
      summary: Basic health check
      description: Returns basic health status of the application including uptime, version, and environment.
      operationId: getHealth
      responses:
        '200':
          description: Service is healthy
          headers:
            X-Response-Time:
              schema:
                type: string
              description: Response time in milliseconds
          content:
            application/json:
              schema:
                type: object
                required:
                  - status
                  - timestamp
                  - uptime
                  - version
                  - environment
                properties:
                  status:
                    type: string
                    enum: [healthy]
                    example: healthy
                  timestamp:
                    type: string
                    format: date-time
                    description: Current server time
                  uptime:
                    type: number
                    description: Process uptime in seconds
                    example: 3600.5
                  version:
                    type: string
                    description: Application version
                    example: 0.2.0
                  environment:
                    type: string
                    enum: [development, staging, production]
                    example: production

  /api/ready:
    get:
      tags:
        - Health
      summary: Readiness probe
      description: |
        Comprehensive readiness check for load balancers and orchestrators.
        Verifies that the application can connect to required services (GraphQL, Auth)
        and is ready to accept traffic.
      operationId: getReadiness
      responses:
        '200':
          description: Application is ready to accept traffic
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReadinessStatus'
        '503':
          description: Application is not ready (service dependencies unavailable)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReadinessStatus'
    head:
      tags:
        - Health
      summary: Quick readiness check
      description: Lightweight readiness check without detailed status
      operationId: headReadiness
      responses:
        '200':
          description: Application is running

  /api/config:
    get:
      tags:
        - Configuration
      summary: Get application configuration
      description: |
        Retrieves the current application configuration including branding, theme, features, and permissions.
        Response is cached for 5 minutes. Add `?history=true` to include recent config changes (admin only).
      operationId: getConfig
      parameters:
        - name: history
          in: query
          description: Include configuration change history (admin only)
          required: false
          schema:
            type: boolean
      responses:
        '200':
          description: Configuration retrieved successfully
          headers:
            Cache-Control:
              schema:
                type: string
              description: Cache control header
          content:
            application/json:
              schema:
                type: object
                properties:
                  config:
                    $ref: '#/components/schemas/AppConfig'
                  version:
                    type: string
                    description: Configuration schema version
                  history:
                    type: array
                    description: Recent configuration changes (only if history=true)
                    items:
                      $ref: '#/components/schemas/ConfigHistoryEntry'
        '403':
          $ref: '#/components/responses/Forbidden'

    post:
      tags:
        - Configuration
      summary: Update application configuration (full update)
      description: |
        Updates the application configuration. Performs a deep merge with existing configuration.
        Requires admin authentication.
      operationId: updateConfig
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AppConfigUpdate'
      responses:
        '200':
          description: Configuration updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  config:
                    $ref: '#/components/schemas/AppConfig'
                  message:
                    type: string
                    example: Configuration updated successfully
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

    patch:
      tags:
        - Configuration
      summary: Update application configuration (partial update)
      description: |
        Partially updates the application configuration. Performs a deep merge with existing configuration.
        Requires admin authentication.
      operationId: patchConfig
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AppConfigUpdate'
      responses:
        '200':
          description: Configuration updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  config:
                    $ref: '#/components/schemas/AppConfig'
                  message:
                    type: string
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  /api/auth/signin:
    post:
      tags:
        - Authentication
      summary: Sign in with email and password
      description: Authenticates a user and returns JWT tokens and user profile.
      operationId: signIn
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                  example: owner@nself.org
                password:
                  type: string
                  format: password
                  example: password123
      responses:
        '200':
          description: Authentication successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          description: Invalid credentials
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Invalid email or password

  /api/auth/signup:
    post:
      tags:
        - Authentication
      summary: Create new user account
      description: Registers a new user account. First user becomes the owner.
      operationId: signUp
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
                - username
              properties:
                email:
                  type: string
                  format: email
                  example: newuser@example.com
                password:
                  type: string
                  format: password
                  minLength: 8
                  example: securePassword123
                username:
                  type: string
                  pattern: '^[a-zA-Z0-9_-]{3,20}$'
                  example: johndoe
                displayName:
                  type: string
                  example: John Doe
      responses:
        '200':
          description: User created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  /api/upload:
    get:
      tags:
        - Upload
      summary: Get upload service status
      description: Returns information about the upload service and file size limits
      operationId: getUploadStatus
      responses:
        '200':
          description: Upload service information
          content:
            application/json:
              schema:
                type: object
                properties:
                  service:
                    type: string
                    example: upload
                  status:
                    type: string
                    enum: [available, unavailable]
                  config:
                    type: object
                    properties:
                      maxFileSize:
                        type: string
                        example: 50 MB
                      allowedTypes:
                        type: array
                        items:
                          type: string
                        example: [images, videos, audio, documents, archives, code]
                      presignedUrlExpiry:
                        type: number
                        description: Presigned URL expiry in seconds
                        example: 900
                  limits:
                    type: array
                    items:
                      type: object
                      properties:
                        type:
                          type: string
                        maxSize:
                          type: string

    post:
      tags:
        - Upload
      summary: Initialize file upload
      description: |
        Initializes a file upload and returns a presigned URL for direct upload to storage.
        The client should then PUT the file to the returned uploadUrl.
      operationId: initUpload
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - filename
                - contentType
                - size
              properties:
                filename:
                  type: string
                  example: document.pdf
                contentType:
                  type: string
                  example: application/pdf
                size:
                  type: integer
                  description: File size in bytes
                  example: 1024000
                channelId:
                  type: string
                  description: Optional channel ID for the upload
                messageId:
                  type: string
                  description: Optional message ID for the upload
      responses:
        '201':
          description: Upload initialized successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UploadInitResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '429':
          $ref: '#/components/responses/TooManyRequests'

  /api/search:
    get:
      tags:
        - Search
      summary: Quick search
      description: Quick text search across all resource types
      operationId: quickSearch
      parameters:
        - name: q
          in: query
          required: true
          description: Search query (minimum 2 characters)
          schema:
            type: string
            minLength: 2
            maxLength: 200
        - name: limit
          in: query
          description: Maximum number of results
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 100
        - name: offset
          in: query
          description: Result offset for pagination
          schema:
            type: integer
            default: 0
            minimum: 0
      responses:
        '200':
          description: Search results
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchResults'
        '400':
          $ref: '#/components/responses/BadRequest'
        '429':
          $ref: '#/components/responses/TooManyRequests'

    post:
      tags:
        - Search
      summary: Advanced search
      description: Advanced search with filters, sorting, and pagination
      operationId: advancedSearch
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SearchRequest'
      responses:
        '200':
          description: Search results with totals and pagination
          content:
            application/json:
              schema:
                type: object
                properties:
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/SearchResultItem'
                  totals:
                    $ref: '#/components/schemas/SearchTotals'
                  query:
                    type: string
                  types:
                    type: array
                    items:
                      type: string
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        '400':
          $ref: '#/components/responses/BadRequest'

  /api/translate:
    post:
      tags:
        - Translation
      summary: Translate text
      description: |
        Translates text to the target language. This is a stub implementation
        that can be integrated with services like Google Translate or DeepL.
      operationId: translateText
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - text
                - targetLanguage
              properties:
                text:
                  type: string
                  maxLength: 5000
                  example: Hello, how are you?
                targetLanguage:
                  type: string
                  example: es
                  description: ISO 639-1 language code
                sourceLanguage:
                  type: string
                  example: en
                  description: Source language (optional, will be detected)
      responses:
        '200':
          description: Translation successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  translatedText:
                    type: string
                    example: Hola, ¿cómo estás?
                  sourceLanguage:
                    type: string
                    example: en
                  targetLanguage:
                    type: string
                    example: es
        '400':
          $ref: '#/components/responses/BadRequest'

  /api/link-preview:
    get:
      tags:
        - Link Preview
      summary: Get link preview metadata
      description: Fetches OpenGraph and Twitter Card metadata for a URL
      operationId: getLinkPreview
      parameters:
        - name: url
          in: query
          required: true
          description: URL to fetch metadata for
          schema:
            type: string
            format: uri
            example: https://github.com
        - name: skipCache
          in: query
          description: Skip cache and fetch fresh data
          schema:
            type: boolean
            default: false
      responses:
        '200':
          description: Preview metadata retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LinkPreviewResponse'
        '400':
          $ref: '#/components/responses/BadRequest'

  /api/webhook/{id}:
    get:
      tags:
        - Webhooks
      summary: Get webhook information
      description: Returns information about a webhook (requires valid token)
      operationId: getWebhook
      parameters:
        - name: id
          in: path
          required: true
          description: Webhook ID
          schema:
            type: string
        - name: token
          in: query
          required: true
          description: Webhook token for authentication
          schema:
            type: string
      responses:
        '200':
          description: Webhook information
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WebhookInfo'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'

    post:
      tags:
        - Webhooks
      summary: Send message via webhook
      description: |
        Receives a webhook payload and creates a message in the associated channel.
        Supports optional signature validation using HMAC.
      operationId: sendWebhook
      parameters:
        - name: id
          in: path
          required: true
          description: Webhook ID
          schema:
            type: string
        - name: token
          in: query
          description: Webhook token (can also be in path as id/token)
          schema:
            type: string
        - name: X-Webhook-Signature
          in: header
          description: HMAC signature for payload validation
          schema:
            type: string
            example: sha256=abc123...
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WebhookPayload'
      responses:
        '200':
          description: Message created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  messageId:
                    type: string
                  channelId:
                    type: string
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '429':
          $ref: '#/components/responses/TooManyRequests'

  /api/audit:
    get:
      tags:
        - Audit
      summary: Query audit logs
      description: Retrieves audit logs with pagination and filtering
      operationId: getAuditLogs
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
            maximum: 100
        - name: q
          in: query
          description: Search query
          schema:
            type: string
        - name: categories
          in: query
          description: Filter by categories (comma-separated)
          schema:
            type: string
            example: auth,config,message
        - name: severities
          in: query
          description: Filter by severities (comma-separated)
          schema:
            type: string
            example: info,warning,error
        - name: actor
          in: query
          description: Filter by actor ID
          schema:
            type: string
        - name: from
          in: query
          description: Start date filter
          schema:
            type: string
            format: date-time
        - name: to
          in: query
          description: End date filter
          schema:
            type: string
            format: date-time
      responses:
        '200':
          description: Audit logs retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/AuditLogResponse'

    post:
      tags:
        - Audit
      summary: Create audit log entry
      description: Creates a new audit log entry
      operationId: createAuditLog
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateAuditLogRequest'
      responses:
        '200':
          description: Audit log created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  data:
                    $ref: '#/components/schemas/AuditLogEntry'

  /api/metrics:
    get:
      tags:
        - Metrics
      summary: Prometheus metrics
      description: |
        Returns application metrics in Prometheus format for monitoring and alerting.
        Includes process metrics, HTTP metrics, and business metrics.
      operationId: getMetrics
      responses:
        '200':
          description: Metrics in Prometheus format
          content:
            text/plain:
              schema:
                type: string
              example: |
                # HELP nchat_http_requests_total Total HTTP requests
                # TYPE nchat_http_requests_total counter
                nchat_http_requests_total{method="GET",status="200"} 1234

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token obtained from /api/auth/signin

  schemas:
    ReadinessStatus:
      type: object
      required:
        - ready
        - timestamp
        - checks
      properties:
        ready:
          type: boolean
          description: Overall readiness status
        timestamp:
          type: string
          format: date-time
        checks:
          type: array
          items:
            type: object
            required:
              - name
              - ready
            properties:
              name:
                type: string
                enum: [graphql, auth, config]
              ready:
                type: boolean
              message:
                type: string

    AppConfig:
      type: object
      description: Complete application configuration
      properties:
        setup:
          type: object
          properties:
            isCompleted:
              type: boolean
            currentStep:
              type: integer
            visitedSteps:
              type: array
              items:
                type: integer
        owner:
          type: object
          properties:
            name:
              type: string
            email:
              type: string
              format: email
            company:
              type: string
            role:
              type: string
        branding:
          type: object
          properties:
            appName:
              type: string
            tagline:
              type: string
            logo:
              type: string
            favicon:
              type: string
            logoScale:
              type: number
              minimum: 0.5
              maximum: 2.0
        theme:
          type: object
          properties:
            preset:
              type: string
            colorScheme:
              type: string
              enum: [light, dark, system]
            primaryColor:
              type: string
              pattern: '^#[0-9A-Fa-f]{6}$'
        features:
          type: object
          properties:
            publicChannels:
              type: boolean
            privateChannels:
              type: boolean
            directMessages:
              type: boolean
            fileUploads:
              type: boolean
            threads:
              type: boolean

    AppConfigUpdate:
      type: object
      description: Partial configuration update (deep merge)
      additionalProperties: true

    ConfigHistoryEntry:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
        updatedBy:
          type: string
          format: email
        changes:
          type: object

    AuthResponse:
      type: object
      required:
        - user
        - accessToken
        - refreshToken
      properties:
        user:
          $ref: '#/components/schemas/User'
        accessToken:
          type: string
          description: JWT access token (24h expiry)
        refreshToken:
          type: string
          description: JWT refresh token (30d expiry)

    User:
      type: object
      required:
        - id
        - email
        - username
        - role
      properties:
        id:
          type: string
        email:
          type: string
          format: email
        username:
          type: string
        displayName:
          type: string
        avatarUrl:
          type: string
          format: uri
        role:
          type: string
          enum: [owner, admin, moderator, member, guest]
        status:
          type: string
          enum: [online, offline, away, busy]

    UploadInitResponse:
      type: object
      required:
        - fileId
        - uploadUrl
        - method
        - expiresAt
        - bucket
        - key
      properties:
        fileId:
          type: string
          description: Unique file identifier
        uploadUrl:
          type: string
          format: uri
          description: Presigned URL for upload
        method:
          type: string
          enum: [PUT, POST]
          description: HTTP method to use for upload
        headers:
          type: object
          additionalProperties:
            type: string
          description: Required headers for upload
        expiresAt:
          type: string
          format: date-time
          description: When the presigned URL expires
        bucket:
          type: string
          description: Storage bucket name
        key:
          type: string
          description: Object key in storage

    SearchRequest:
      type: object
      required:
        - query
      properties:
        query:
          type: string
          minLength: 2
          maxLength: 200
        types:
          type: array
          items:
            type: string
            enum: [messages, files, users, channels]
        channelIds:
          type: array
          items:
            type: string
        userIds:
          type: array
          items:
            type: string
        dateFrom:
          type: string
          format: date-time
        dateTo:
          type: string
          format: date-time
        limit:
          type: integer
          minimum: 1
          maximum: 100
          default: 20
        offset:
          type: integer
          minimum: 0
          default: 0
        sortBy:
          type: string
          enum: [relevance, date]
          default: relevance
        sortOrder:
          type: string
          enum: [asc, desc]
          default: desc

    SearchResults:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/SearchResultItem'
        total:
          type: integer
        page:
          type: integer
        limit:
          type: integer

    SearchResultItem:
      type: object
      required:
        - id
        - type
        - title
        - createdAt
      properties:
        id:
          type: string
        type:
          type: string
          enum: [messages, files, users, channels]
        title:
          type: string
        content:
          type: string
        snippet:
          type: string
        highlight:
          type: string
        score:
          type: number
        channelId:
          type: string
        channelName:
          type: string
        userId:
          type: string
        userName:
          type: string
        avatarUrl:
          type: string
        createdAt:
          type: string
          format: date-time
        metadata:
          type: object

    SearchTotals:
      type: object
      properties:
        messages:
          type: integer
        files:
          type: integer
        users:
          type: integer
        channels:
          type: integer
        total:
          type: integer

    LinkPreviewResponse:
      type: object
      required:
        - success
      properties:
        success:
          type: boolean
        url:
          type: string
          format: uri
        title:
          type: string
        description:
          type: string
        image:
          type: string
          format: uri
        siteName:
          type: string
        cached:
          type: boolean
        error:
          type: string
        errorCode:
          type: string

    WebhookInfo:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        channel_id:
          type: string
        status:
          type: string
          enum: [active, inactive]
        created_at:
          type: string
          format: date-time
        last_used_at:
          type: string
          format: date-time

    WebhookPayload:
      type: object
      required:
        - content
      properties:
        content:
          type: string
          maxLength: 2000
          description: Message content
        username:
          type: string
          description: Override webhook display name
        avatar_url:
          type: string
          format: uri
          description: Override webhook avatar
        embeds:
          type: array
          maxItems: 10
          items:
            type: object
            properties:
              title:
                type: string
              description:
                type: string
              url:
                type: string
              color:
                type: string
              image:
                type: object
                properties:
                  url:
                    type: string

    AuditLogEntry:
      type: object
      required:
        - id
        - timestamp
        - category
        - action
        - severity
        - actor
        - description
        - success
      properties:
        id:
          type: string
        timestamp:
          type: string
          format: date-time
        category:
          type: string
          enum: [auth, config, message, channel, user, file, admin]
        action:
          type: string
        severity:
          type: string
          enum: [debug, info, warning, error, critical]
        actor:
          type: object
          properties:
            id:
              type: string
            type:
              type: string
              enum: [user, system, bot, integration, anonymous]
            email:
              type: string
            username:
              type: string
        description:
          type: string
        success:
          type: boolean
        errorMessage:
          type: string
        metadata:
          type: object

    AuditLogResponse:
      type: object
      properties:
        entries:
          type: array
          items:
            $ref: '#/components/schemas/AuditLogEntry'
        total:
          type: integer
        page:
          type: integer
        pageSize:
          type: integer

    CreateAuditLogRequest:
      type: object
      required:
        - category
        - action
        - severity
        - actor
        - description
        - success
      properties:
        category:
          type: string
        action:
          type: string
        severity:
          type: string
        actor:
          type: object
        description:
          type: string
        success:
          type: boolean
        metadata:
          type: object

    Pagination:
      type: object
      properties:
        total:
          type: integer
        limit:
          type: integer
        offset:
          type: integer
        hasMore:
          type: boolean

  responses:
    BadRequest:
      description: Invalid request parameters
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              error:
                type: string
                example: Invalid request
              code:
                type: string
                example: BAD_REQUEST

    Unauthorized:
      description: Authentication required or invalid token
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              error:
                type: string
                example: Authentication required
              code:
                type: string
                example: UNAUTHORIZED

    Forbidden:
      description: Insufficient permissions
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              error:
                type: string
                example: Admin access required
              code:
                type: string
                example: FORBIDDEN

    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              error:
                type: string
                example: Resource not found
              code:
                type: string
                example: NOT_FOUND

    TooManyRequests:
      description: Rate limit exceeded
      headers:
        X-RateLimit-Limit:
          schema:
            type: integer
          description: Maximum requests per window
        X-RateLimit-Remaining:
          schema:
            type: integer
          description: Remaining requests in current window
        X-RateLimit-Reset:
          schema:
            type: integer
          description: Unix timestamp when limit resets
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              error:
                type: string
                example: Rate limit exceeded
              code:
                type: string
                example: RATE_LIMIT_EXCEEDED
